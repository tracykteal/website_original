<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html40/loose.dtd">

<html>
         
  <head>
    <title>Module: oligoselect</title>
  </head>

  <body bgcolor="#ffffff">

        <p><i><a href="index.html">Table of Contents</a></i></p>
        
        <table border="0" cellpadding="5" cellspacing="0" width="100%">
        <tr bgcolor="#88bbee">
            <th rowspan="2"
                valign="top"
                align="left"
                width="10%"><font color="#000000">Module: oligoselect</font>
            </th>
            <th width="90%" align="right"><font color="#000000">oligoselect.py</font></th>
        </tr>
        <tr>
        <td>
        
<table border="0" cellpadding="5" cellspacing="0" width="100%">

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Imported modules">Imported modules</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-array.html">array</a><br>
<b>from</b> <a href="http://www.python.org/doc/current/lib/module-array.html">array</a> <b>import</b> array<br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-copy.html">copy</a><br>
<b>import</b> fasta<br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-os.html">os</a><br>
<b>import</b> os.path<br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-string.html">string</a><br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-sys.html">sys</a><br>
<b>import</b> <a href="http://www.python.org/doc/current/lib/module-tempfile.html">tempfile</a><br>

</td></tr>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="Functions">Functions</a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        

            <table border="0" cellspacing="2" cellpadding="2" width="100%">
              <tr>
            <td align="LEFT" valign="TOP">
<a href="#a_count">a_count</a><br>
<a href="#base_fifty_percent">base_fifty_percent</a><br>
<a href="#c_count">c_count</a><br>
<a href="#check_criteria">check_criteria</a><br>
<a href="#contiguous">contiguous</a><br>
<a href="#do_blast">do_blast</a><br>
</td>
<td align="LEFT" valign="TOP">
<a href="#find_oligo">find_oligo</a><br>
<a href="#g_count">g_count</a><br>
<a href="#main">main</a><br>
<a href="#make_oligo">make_oligo</a><br>
<a href="#self_annealing">self_annealing</a><br>
<a href="#t_count">t_count</a><br>
</td>
</tr>
            </table>
            

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="a_count"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">a_count&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
a_count ( sequence )

</pre></font>

<p>Count the number of A's in the sequence</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="base_fifty_percent"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">base_fifty_percent&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
base_fifty_percent ( seq )

</pre></font>

<p>Check to see if any single base exceeds 50% of the probe size</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="c_count"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">c_count&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
c_count ( sequence )

</pre></font>

<p>Count the number of C's in the sequence</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="check_criteria"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">check_criteria&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
check_criteria (
        candidate,
        gc_min,
        gc_max,
        percent_match,
        gene,
        database,
        oligo_length,
        )

</pre></font>

<p>If the gc content is correct, the sequence is unique, no single
   base exceeds 50% of the oligo size, the length of any contiguous
   A, T, G or C region is less than 25% and it's
   not self-annealing, you've found your oligo.</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="contiguous"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">contiguous&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
contiguous ( sequence )

</pre></font>

<p>Go through every segment of the oligo that is the length
   of 25% of the oligo and determine if it is all A's, T's,
   G's or C's.  If it is, there is a contiguos region that is
   25% or more of the oligo.  Since 25% is the minimum case, this
   will find regions of 25% or more.</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="do_blast"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">do_blast&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
do_blast (
        gene,
        sequence,
        oligo_length,
        blast_database,
        )

</pre></font>

<p>Create a temporary file of the oligo in fasta format so it can
   be blasted against the database</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="find_oligo"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">find_oligo&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
find_oligo (
        gene,
        seq,
        oligo_length,
        gc_min,
        gc_max,
        percent_match,
        num_matches,
        database,
        f,
        )

</pre></font>

<p>****<strong> Find the oligos! </strong>********</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="g_count"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">g_count&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
g_count ( sequence )

</pre></font>

<p>Count the number of G's in the sequence</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="main"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">main&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
main ()

</pre></font>

<p>Main function</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="make_oligo"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">make_oligo&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
make_oligo (
        input_file_name,
        gclist,
        f,
        oligo_length,
        database,
        gc_min,
        gc_max,
        percent_match,
        num_matches,
        )

</pre></font>

<p>Make the oligos</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="self_annealing"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">self_annealing&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
self_annealing ( seq )

</pre></font>

<p>Create a matrix with the sequence on the top and the
   reverse complement on the side.  If the bases are the
   same the matrix value is 1, otherwise it is 0.  If the
   sum of a diagonal line is more than 40% of the probe
   length, the probe is substantially self complementary
   (Li and Stormo, 2001)</p>

        <tr>
            <th bgcolor="#99ccff"
                rowspan="2"
                valign="top"
                align="left"
                width="20%"
                >
                <font color="#000000">
                  <a name="t_count"></a>&nbsp;
                </font>
            </th>
            <th bgcolor="#99ccff"
                valign="top"
                align="left"
                width="80%"
                >
                <font color="#000000">t_count&nbsp;</font>
            </th>
        </tr>
        <tr>
        <td>
        <font color="#000088"><pre>
t_count ( sequence )

</pre></font>

<p>Count the number of T's in the sequence</p>
</td></tr>
</td></tr>
</table>

        </td>
        </tr>
        </table>

        <hr>

        <p><i><a href="index.html">Table of Contents</a></i></p>

        <font size="-2"><i>This document was automatically generated
        on Thu Sep 19 12:06:44 2002 by
        <a href="http://happydoc.sourceforge.net">HappyDoc</a> version
        2.0</i></font>
        
        </body>
        </html>
        